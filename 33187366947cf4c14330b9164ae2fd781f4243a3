{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "36cc07f5_274dc027",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1054778
      },
      "writtenOn": "2024-08-19T18:39:51Z",
      "side": 1,
      "message": "I am getting this error when running it with 8.6.2. Trying to figure out why:\n\n```\nspark-job-for-8.6.2  | org.apache.spark.SparkException: Job aborted due to stage failure: Task 11 in stage 1.0 failed 1 times, most recent failure: Lost task 11.0 in stage 1.0 (TID 25, localhost, executor driver): org.elasticsearch.hadoop.EsHadoopIllegalArgumentException: Detected type name in resource [gitcommitslocalenv_2024-08-19_1724092114032/gitCommits]. Remove type name to continue.\nspark-job-for-8.6.2  | \tat org.elasticsearch.hadoop.rest.Resource.\u003cinit\u003e(Resource.java:88)\nspark-job-for-8.6.2  | \tat org.elasticsearch.hadoop.rest.RestService.createWriter(RestService.java:595)\nspark-job-for-8.6.2  | \tat org.elasticsearch.spark.rdd.EsRDDWriter.write(EsRDDWriter.scala:71)\nspark-job-for-8.6.2  | \tat org.elasticsearch.spark.sql.EsSparkSQL$$anonfun$saveToEs$1.apply(EsSparkSQL.scala:103)\nspark-job-for-8.6.2  | \tat org.elasticsearch.spark.sql.EsSparkSQL$$anonfun$saveToEs$1.apply(EsSparkSQL.scala:103)\nspark-job-for-8.6.2  | \tat org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:90)\nspark-job-for-8.6.2  | \tat org.apache.spark.scheduler.Task.run(Task.scala:123)\nspark-job-for-8.6.2  | \tat org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)\nspark-job-for-8.6.2  | \tat org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)\nspark-job-for-8.6.2  | \tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)\nspark-job-for-8.6.2  | \tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\nspark-job-for-8.6.2  | \tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\nspark-job-for-8.6.2  | \tat java.lang.Thread.run(Thread.java:748)\nspark-job-for-8.6.2  |\nspark-job-for-8.6.2  | Driver stacktrace:\nspark-job-for-8.6.2  | \tat org.apache.spark.scheduler.DAGScheduler.org$apache$spark$scheduler$DAGScheduler$$failJobAndIndependentStages(DAGScheduler.scala:1891)\nspark-job-for-8.6.2  | \tat org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1879)\nspark-job-for-8.6.2  | \tat org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1878)\nspark-job-for-8.6.2  | \tat scala.collection.mutable.ResizableArray$class.foreach(ResizableArray.scala:59)\nspark-job-for-8.6.2  | \tat scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:48)\nspark-job-for-8.6.2  | \tat org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:1878)\nspark-job-for-8.6.2  | \tat org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:927)\nspark-job-for-8.6.2  | \tat org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:927)\nspark-job-for-8.6.2  | \tat scala.Option.foreach(Option.scala:257)\nspark-job-for-8.6.2  | \tat org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:927)\nspark-job-for-8.6.2  | \tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:2112)\nspark-job-for-8.6.2  | \tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2061)\nspark-job-for-8.6.2  | \tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2050)\nspark-job-for-8.6.2  | \tat org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)\nspark-job-for-8.6.2  | \tat org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:738)\nspark-job-for-8.6.2  | \tat org.apache.spark.SparkContext.runJob(SparkContext.scala:2061)\nspark-job-for-8.6.2  | \tat org.apache.spark.SparkContext.runJob(SparkContext.scala:2082)\nspark-job-for-8.6.2  | \tat org.apache.spark.SparkContext.runJob(SparkContext.scala:2114)\nspark-job-for-8.6.2  | \tat org.elasticsearch.spark.sql.EsSparkSQL$.saveToEs(EsSparkSQL.scala:103)\nspark-job-for-8.6.2  | \tat org.elasticsearch.spark.sql.EsSparkSQL$.saveToEs(EsSparkSQL.scala:81)\nspark-job-for-8.6.2  | \tat org.elasticsearch.spark.sql.package$SparkDataFrameFunctions.saveToEs(package.scala:48)\nspark-job-for-8.6.2  | \tat com.gerritforge.analytics.infrastructure.ElasticSearchPimpedWriter.saveToEsWithAliasSwap(esSparkWriter.scala:55)\nspark-job-for-8.6.2  | \tat com.gerritforge.analytics.gitcommits.job.Job$$anonfun$saveES$1.apply(Main.scala:144)\nspark-job-for-8.6.2  | \tat com.gerritforge.analytics.gitcommits.job.Job$$anonfun$saveES$1.apply(Main.scala:142)\nspark-job-for-8.6.2  | \tat scala.Option.foreach(Option.scala:257)\nspark-job-for-8.6.2  | \tat com.gerritforge.analytics.gitcommits.job.Job$class.saveES(Main.scala:142)\nspark-job-for-8.6.2  | \tat com.gerritforge.analytics.gitcommits.job.Main$.saveES(Main.scala:33)\nspark-job-for-8.6.2  | \tat com.gerritforge.analytics.gitcommits.job.Main$.delayedEndpoint$com$gerritforge$analytics$gitcommits$job$Main$1(Main.scala:106)\nspark-job-for-8.6.2  | \tat com.gerritforge.analytics.gitcommits.job.Main$delayedInit$body.apply(Main.scala:33)\nspark-job-for-8.6.2  | \tat scala.Function0$class.apply$mcV$sp(Function0.scala:34)\nspark-job-for-8.6.2  | \tat scala.runtime.AbstractFunction0.apply$mcV$sp(AbstractFunction0.scala:12)\nspark-job-for-8.6.2  | \tat scala.App$$anonfun$main$1.apply(App.scala:76)\nspark-job-for-8.6.2  | \tat scala.App$$anonfun$main$1.apply(App.scala:76)\nspark-job-for-8.6.2  | \tat scala.collection.immutable.List.foreach(List.scala:392)\nspark-job-for-8.6.2  | \tat scala.collection.generic.TraversableForwarder$class.foreach(TraversableForwarder.scala:35)\nspark-job-for-8.6.2  | \tat scala.App$class.main(App.scala:76)\nspark-job-for-8.6.2  | \tat com.gerritforge.analytics.gitcommits.job.Main$.main(Main.scala:33)\nspark-job-for-8.6.2  | \tat com.gerritforge.analytics.gitcommits.job.Main.main(Main.scala)\nspark-job-for-8.6.2  | \tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nspark-job-for-8.6.2  | \tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nspark-job-for-8.6.2  | \tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\nspark-job-for-8.6.2  | \tat java.lang.reflect.Method.invoke(Method.java:498)\nspark-job-for-8.6.2  | \tat org.apache.spark.deploy.JavaMainApplication.start(SparkApplication.scala:52)\nspark-job-for-8.6.2  | \tat org.apache.spark.deploy.SparkSubmit.org$apache$spark$deploy$SparkSubmit$$runMain(SparkSubmit.scala:845)\nspark-job-for-8.6.2  | \tat org.apache.spark.deploy.SparkSubmit.doRunMain$1(SparkSubmit.scala:161)\nspark-job-for-8.6.2  | \tat org.apache.spark.deploy.SparkSubmit.submit(SparkSubmit.scala:184)\nspark-job-for-8.6.2  | \tat org.apache.spark.deploy.SparkSubmit.doSubmit(SparkSubmit.scala:86)\nspark-job-for-8.6.2  | \tat org.apache.spark.deploy.SparkSubmit$$anon$2.doSubmit(SparkSubmit.scala:920)\nspark-job-for-8.6.2  | \tat org.apache.spark.deploy.SparkSubmit$.main(SparkSubmit.scala:929)\nspark-job-for-8.6.2  | \tat org.apache.spark.deploy.SparkSubmit.main(SparkSubmit.scala)\nspark-job-for-8.6.2  | Caused by: org.elasticsearch.hadoop.EsHadoopIllegalArgumentException: Detected type name in resource [gitcommitslocalenv_2024-08-19_1724092114032/gitCommits]. Remove type name to continue.\nspark-job-for-8.6.2  | \tat org.elasticsearch.hadoop.rest.Resource.\u003cinit\u003e(Resource.java:88)\nspark-job-for-8.6.2  | \tat org.elasticsearch.hadoop.rest.RestService.createWriter(RestService.java:595)\nspark-job-for-8.6.2  | \tat org.elasticsearch.spark.rdd.EsRDDWriter.write(EsRDDWriter.scala:71)\nspark-job-for-8.6.2  | \tat org.elasticsearch.spark.sql.EsSparkSQL$$anonfun$saveToEs$1.apply(EsSparkSQL.scala:103)\nspark-job-for-8.6.2  | \tat org.elasticsearch.spark.sql.EsSparkSQL$$anonfun$saveToEs$1.apply(EsSparkSQL.scala:103)\nspark-job-for-8.6.2  | \tat org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:90)\nspark-job-for-8.6.2  | \tat org.apache.spark.scheduler.Task.run(Task.scala:123)\nspark-job-for-8.6.2  | \tat org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)\nspark-job-for-8.6.2  | \tat org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)\nspark-job-for-8.6.2  | \tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)\nspark-job-for-8.6.2  | \tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\nspark-job-for-8.6.2  | \tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\nspark-job-for-8.6.2  | \tat java.lang.Thread.run(Thread.java:748)\n\n```",
      "revId": "33187366947cf4c14330b9164ae2fd781f4243a3",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    }
  ]
}